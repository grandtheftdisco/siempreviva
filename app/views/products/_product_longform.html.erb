<!-- Section 1 -->
<div id="section-1" class="lg:contents">
  <!-- Frame 1: Initial viewport content (mobile only) -->
  <div class="lg:hidden relative -mx-4 -mt-4 px-4 pt-4 pb-8">
    <!-- Mobile Header - Breadcrumb & Title -->
    <div class="mb-4 max-[400px]:mb-2">
      <!-- Breadcrumb Navigation -->
      <nav class="breadcrumb-nav mb-4 max-[400px]:mb-2" style="font-family: 'Playfair Display', serif; font-size: 0.875rem; color: #6c757d;">
        <%= link_to "essential oils", products_path, class: "breadcrumb-link" %>
        <span class="breadcrumb-separator mx-2">></span>
        <span class="current-page"><%= format_product_name(@product.name) %></span>
      </nav>

      <!-- Page Title -->
      <h1 class="product-show-title"><%= format_product_name(@product.name) %></h1>
    </div>

    <!-- Product Image, Price, Description (mobile only) -->
    <div class="flex flex-col">
      <div class="flex items-center justify-center bg-gray-100 rounded-lg mb-4">
        <% if @product.images.any? %>
          <%= image_tag(@product.images.first, alt: @product.name.titleize, class: "max-w-full h-auto max-h-[40vh] max-[400px]:max-h-[30vh] rounded-lg object-cover") %>
        <% else %>
          <div class="w-full h-96 bg-gray-200 rounded-lg flex items-center justify-center">
            <span class="text-gray-500">Product Image</span>
          </div>
        <% end %>
      </div>

      <!-- Price -->
      <div class="text-2xl text-center text-gray-800 mb-4 max-[400px]:mb-2 max-[400px]:!text-4xl" style="font-family: 'Playfair Display', serif; font-size: 3rem;">
        <%= to_dollars(@product.default_price.unit_amount) %>
      </div>

      <!-- Description -->
      <div class="prose prose-lg text-gray-600 mb-4">
        <% if @product.description.present? %>
          <%= simple_format(@product.description) %>
        <% else %>
          <p>100% natural sage essential oil, made in Europe.</p>
        <% end %>
      </div>

      <!-- Add to Bag (mobile only, non-floating) -->
      <%= form_for :cart_item, url: cart_items_path, method: :post, class: "flex flex-col items-center" do |f| %>
        <%= hidden_field_tag 'cart_item[stripe_product_id]', @product.id %>
        <%= f.submit "Add to Bag", class: "w-full max-w-md px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-300 font-medium text-lg" %>
      <% end %>
    </div>
  </div>

  <!-- Desktop Grid (hidden on mobile) -->
  <div class="hidden lg:block">
    <!-- Mobile Header - Breadcrumb & Title (visible on mobile/tablet, hidden on lg+) -->
    <div class="block lg:hidden mb-6">
      <!-- Breadcrumb Navigation -->
      <nav class="breadcrumb-nav mb-4" style="font-family: 'Playfair Display', serif; font-size: 0.875rem; color: #6c757d;">
        <%= link_to "essential oils", products_path, class: "breadcrumb-link" %>
        <span class="breadcrumb-separator mx-2">></span>
        <span class="current-page"><%= format_product_name(@product.name) %></span>
      </nav>

      <!-- Page Title -->
      <h1 class="product-show-title"><%= format_product_name(@product.name) %></h1>
    </div>

    <!-- Element #1 in Stack - Product Content Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12 max-[400px]:mb-6">

  <!-- Left Column - Product Image -->
  <div class="flex items-stretch">
    <div class="w-full flex items-center justify-center bg-gray-100 rounded-lg">
      <% if @product.images.any? %>
        <%= image_tag(@product.images.first, alt: @product.name.titleize, class: "max-w-full h-auto max-h-[40vh] max-[400px]:max-h-[30vh] lg:max-h-none rounded-lg object-cover") %>
      <% else %>
        <div class="w-full h-96 bg-gray-200 rounded-lg flex items-center justify-center">
          <span class="text-gray-500">Product Image</span>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Right Column - Product Details -->
  <div class="flex flex-col justify-start">
    <!-- Desktop Breadcrumb & Title (hidden on mobile, visible on lg+) -->
    <div class="hidden lg:block">
      <nav class="breadcrumb-nav mb-2" style="font-family: 'Playfair Display', serif; font-size: 0.875rem; color: #6c757d;">
        <%= link_to "essential oils", products_path, class: "breadcrumb-link" %>
        <span class="breadcrumb-separator mx-2">></span>
        <span class="current-page"><%= format_product_name(@product.name) %></span>
      </nav>
      <h1 class="product-show-title"><%= format_product_name(@product.name) %></h1>
    </div>

    <div id="key-product-info" class="mb-5 max-[400px]:mb-2 lg:mb-10">
      <!-- Price -->
      <div class="text-2xl lg:text-2xl text-center lg:text-left text-gray-800 mb-5 max-[400px]:mb-2 max-[400px]:!text-4xl" style="font-family: 'Playfair Display', serif; font-size: 3rem;">
          <%= to_dollars(@product.default_price.unit_amount) %>
        </div>

      <!-- Description (desktop only, moved to Section 2 on mobile) -->
      <div class="hidden lg:block prose prose-lg text-gray-600">
        <% if @product.description.present? %>
          <%= simple_format(@product.description) %>
        <% else %>
          <p>100% natural sage essential oil, made in Europe.</p>
        <% end %>
      </div>
    </div>

    <!-- Desktop Add to Cart Form (hidden on mobile/tablet) -->
    <%= form_for :cart_item, url: cart_items_path, method: :post, class: "hidden lg:block space-y-4 !w-full !mx-0", style: "width: auto; margin: 0; padding: 0; max-width: none;" do |f| %>
      <div class="flex items-center gap-3 justify-start w-full !ml-0">
        <%= hidden_field_tag 'cart_item[stripe_product_id]', @product.id, class: '!m-0 !mb-0' %>

        <%= f.label :quantity, "Quantity:" %>

        <!-- Flowbite Quantity Selector -->
        <div class="relative flex items-center max-w-[8rem]">
          <button type="button" id="decrement-button" data-input-counter-decrement="quantity-input" class="quantity-button">
            <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 18 2">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h16"/>
            </svg>
          </button>
          <%= f.number_field :quantity,
                value: 1,
                min: 1,
                id: "quantity-input",
                data: { input_counter: true },
                class: "text-center text-sm block w-full" %>
          <button type="button" id="increment-button" data-input-counter-increment="quantity-input" class="quantity-button">
            <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 18 18">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 1v16M1 9h16"/>
            </svg>
          </button>
        </div>
      </div>
      <div>
        <%= f.submit "Add to Bag", id: "add-to-bag-button", class: "px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-300" %>
      </div>
    <% end %>

    <!-- Product Features/Benefits (desktop only - moved to section 2 on mobile) -->
    <div class="hidden lg:block space-y-2">
      <ul class="list-disc list-inside text-gray-600 space-y-1 text-sm">
        <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit</li>
        <li>Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua</li>
        <li>Ut enim ad minim veniam, quis nostrud exercitation</li>
        <li>Duis aute irure dolor in reprehenderit in voluptate velit esse</li>
        <li>Excepteur sint occaecat cupidatat non proident</li>
        <li>Sunt in culpa qui officia deserunt mollit anim id est laborum</li>
      </ul>
    </div>
  </div>
</div>
  </div>
</div>

<!-- Section 2: Product Details/Images Grid (mobile only) -->
<div id="section-2" class="lg:hidden pt-8 pb-4 border-t mx-4">
  <div>
    <!-- 2x2 Product Images Grid -->
    <div class="grid grid-cols-2 gap-4 px-4 mb-6">
      <div class="bg-gray-200 h-40 rounded-lg flex items-center justify-center">
        <span class="text-gray-500">Image 1</span>
      </div>
      <div class="bg-gray-200 h-40 rounded-lg flex items-center justify-center">
        <span class="text-gray-500">Image 2</span>
      </div>
      <div class="bg-gray-200 h-40 rounded-lg flex items-center justify-center">
        <span class="text-gray-500">Image 3</span>
      </div>
      <div class="bg-gray-200 h-40 rounded-lg flex items-center justify-center">
        <span class="text-gray-500">Image 4</span>
      </div>
    </div>

    <!-- Product Description -->
    <div class="px-4 mb-6">
      <div class="prose prose-lg text-gray-600 mb-4">
        <% if @product.description.present? %>
          <%= simple_format(@product.description) %>
        <% else %>
          <p>100% natural sage essential oil, made in Europe.</p>
        <% end %>
      </div>

      <!-- Product Features/Benefits -->
      <ul class="list-disc list-inside text-gray-600 space-y-1 text-sm">
        <li>Euismod in pellentesque massa placerat duis ultricies</li>
        <li>Nisi est sit amet facilisis magna etiam</li>
        <li>Non curabitur gravida arcu ac tortor dignissim</li>
        <li>Mattis sodales faucibus, aenean vulputate consectetur et nunc potenti auque</li>
        <li>Proin morbis eros nostra rutrum montes suspendisse</li>
        <li>Aneque nunc hendrerit ligula praesent taciti</li>
      </ul>
    </div>
  </div>
</div>

<!-- Cross-sell Section -->
<div id="section-3" class="mt-8 pt-8 border-t mx-4 lg:mx-8">
    <h2 class="text-2xl font-light font-serif mb-8 text-center" style="font-family: 'Playfair Display', serif;">you may also like</h2>

    <div class="flex flex-col md:flex-row justify-center items-center md:items-start gap-8 lg:gap-12">
      <!-- Cross-sell Product 1 -->
      <div class="text-center flex-shrink-0">
        <div class="bg-gray-200 h-40 w-80 rounded-lg mb-3 flex items-center justify-center">
          <span class="text-gray-500">Product Image</span>
        </div>
        <h3 class="font-medium text-gray-800 mb-1">rose</h3>
        <p class="text-gray-600">$XX.XX</p>
      </div>

      <!-- Cross-sell Product 2 -->
      <div class="text-center flex-shrink-0">
        <div class="bg-gray-200 h-40 w-80 rounded-lg mb-3 flex items-center justify-center">
          <span class="text-gray-500">Product Image</span>
        </div>
        <h3 class="font-medium text-gray-800 mb-1">roman chamomile</h3>
        <p class="text-gray-600">$XX.XX</p>
      </div>

      <!-- Cross-sell Product 3 -->
      <div class="text-center flex-shrink-0">
        <div class="bg-gray-200 h-40 w-80 rounded-lg mb-3 flex items-center justify-center">
          <span class="text-gray-500">Product Image</span>
        </div>
        <h3 class="font-medium text-gray-800 mb-1">helichrysum</h3>
        <p class="text-gray-600">$XX.XX</p>
      </div>
    </div>
</div>