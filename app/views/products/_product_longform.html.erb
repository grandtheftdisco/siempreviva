<!-- Section 1 -->
<div id="section-1" class="lg:contents">
  <!-- Frame 1: Initial viewport content (mobile only) -->
  <div class="lg:hidden relative -mx-4 -mt-4 px-4 pt-4 pb-8 md:mx-auto md:mt-0 md:max-w-2xl">
    <!-- Mobile Header - Breadcrumb & Title -->
    <div class="mb-4 max-[400px]:mb-2">
      <!-- Breadcrumb Navigation -->
      <nav class="breadcrumb-nav mb-4 max-[400px]:mb-2">
        <%= link_to "essential oils", products_path, class: "breadcrumb-link" %>
        <span class="breadcrumb-separator">></span>
        <span class="current-page"><%= format_product_name(@product.name) %></span>
      </nav>

      <!-- Page Title -->
      <h1 class="product-show-title"><%= format_product_name(@product.name) %></h1>
    </div>

    <!-- Product Image, Price, Description (mobile only) -->
    <div class="flex flex-col">
      <div class="flex items-center justify-center bg-gray-100 rounded-lg mb-4">
        <% if @product.images.any? %>
          <%= image_tag(@product.images.first, alt: @product.name.titleize, class: "max-w-full h-auto max-h-[40vh] max-[400px]:max-h-[30vh] rounded-lg object-cover") %>
        <% else %>
          <div class="w-full h-96 bg-gray-200 rounded-lg flex items-center justify-center">
            <span class="text-gray-500">Product Image</span>
          </div>
        <% end %>
      </div>

      <!-- Price -->
      <div class="product-price-display mb-4 max-[400px]:mb-2">
        <%= to_dollars(@product.default_price.unit_amount) %>
      </div>

      <!-- Description -->
      <div class="prose prose-lg text-gray-600 mb-4">
        <% if @product.description.present? %>
          <%= simple_format(@product.description) %>
        <% else %>
          <p>100% natural sage essential oil, made in Europe.</p>
        <% end %>
      </div>

      <!-- Add to Bag (mobile only, non-floating) -->
      <%= form_for :cart_item, url: cart_items_path, method: :post, class: "flex justify-center mx-auto" do |f| %>
        <%= hidden_field_tag 'cart_item[stripe_product_id]', @product.id %>
        <%= f.submit "Add to Bag", class: "w-full max-w-md px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-300 font-medium text-lg" %>
      <% end %>
    </div>
  </div>

  <!-- Desktop Grid (hidden on mobile) -->
  <div class="hidden lg:block">
    <!-- Mobile Header - Breadcrumb & Title (visible on mobile/tablet, hidden on lg+) -->
    <div class="block lg:hidden mb-6">
      <!-- Breadcrumb Navigation -->
      <nav class="breadcrumb-nav mb-4">
        <%= link_to "essential oils", products_path, class: "breadcrumb-link" %>
        <span class="breadcrumb-separator">></span>
        <span class="current-page"><%= format_product_name(@product.name) %></span>
      </nav>

      <!-- Page Title -->
      <h1 class="product-show-title"><%= format_product_name(@product.name) %></h1>
    </div>

    <!-- Element #1 in Stack - Product Content Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12 max-[400px]:mb-6">

  <!-- Left Column - Product Image -->
  <div class="flex items-stretch">
    <div class="w-full flex items-center justify-center bg-gray-100 rounded-lg">
      <% if @product.images.any? %>
        <%= image_tag(@product.images.first, alt: @product.name.titleize, class: "max-w-full h-auto max-h-[40vh] max-[400px]:max-h-[30vh] lg:max-h-none rounded-lg object-cover") %>
      <% else %>
        <div class="w-full h-96 bg-gray-200 rounded-lg flex items-center justify-center">
          <span class="text-gray-500">Product Image</span>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Right Column - Product Details -->
  <div class="flex flex-col justify-start">
    <!-- Desktop Breadcrumb & Title (hidden on mobile, visible on lg+) -->
    <div class="hidden lg:block">
      <nav class="breadcrumb-nav mb-2">
        <%= link_to "essential oils", products_path, class: "breadcrumb-link" %>
        <span class="breadcrumb-separator">></span>
        <span class="current-page"><%= format_product_name(@product.name) %></span>
      </nav>
      <h1 class="product-show-title"><%= format_product_name(@product.name) %></h1>
    </div>

    <div id="key-product-info" class="mb-5 max-[400px]:mb-2 lg:mb-10">
      <!-- Price -->
      <div class="product-price-display mb-5 max-[400px]:mb-2">
          <%= to_dollars(@product.default_price.unit_amount) %>
        </div>

      <!-- Description (desktop only, moved to Section 2 on mobile) -->
      <div class="hidden lg:block prose prose-lg text-gray-600">
        <% if @product.description.present? %>
          <%= simple_format(@product.description) %>
        <% else %>
          <p>100% natural sage essential oil, made in Europe.</p>
        <% end %>
      </div>
    </div>

    <!-- Desktop Add to Cart Form (hidden on mobile/tablet) -->
    <%= form_for :cart_item, url: cart_items_path, method: :post, class: "hidden lg:block space-y-4 !w-full !mx-0", style: "width: auto; margin: 0; padding: 0; max-width: none;" do |f| %>
      <div class="flex items-center gap-3 justify-start w-full !ml-0">
        <%= hidden_field_tag 'cart_item[stripe_product_id]', @product.id, class: '!m-0 !mb-0' %>

        <%= f.label :quantity, "Quantity:" %>
        <%= render 'shared/quantity_selector', input_id: 'quantity-input', initial_value: 1, min_value: 1 %>
      </div>
      <div>
        <%= f.submit "Add to Bag", id: "add-to-bag-button", class: "px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-300" %>
      </div>
    <% end %>

    <!-- Product Features/Benefits (desktop only - moved to section 2 on mobile) -->
    <div class="hidden lg:block space-y-2">
      <ul class="list-disc list-inside text-gray-600 space-y-1 text-sm">
        <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit</li>
        <li>Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua</li>
        <li>Ut enim ad minim veniam, quis nostrud exercitation</li>
        <li>Duis aute irure dolor in reprehenderit in voluptate velit esse</li>
        <li>Excepteur sint occaecat cupidatat non proident</li>
        <li>Sunt in culpa qui officia deserunt mollit anim id est laborum</li>
      </ul>
    </div>
  </div>
</div>
  </div>
</div>

<!-- Additional Product Images (desktop only) -->
<div class="hidden lg:block mb-12 pt-8 border-t mx-4 lg:mx-8">
  <div class="grid grid-cols-2 gap-4 max-w-lg mx-auto">
    <div class="bg-gray-200 h-32 rounded-lg flex items-center justify-center">
      <span class="text-gray-500 text-sm">Image 2</span>
    </div>
    <div class="bg-gray-200 h-32 rounded-lg flex items-center justify-center">
      <span class="text-gray-500 text-sm">Image 3</span>
    </div>
    <div class="bg-gray-200 h-32 rounded-lg flex items-center justify-center">
      <span class="text-gray-500 text-sm">Image 4</span>
    </div>
    <div class="bg-gray-200 h-32 rounded-lg flex items-center justify-center">
      <span class="text-gray-500 text-sm">Image 5</span>
    </div>
  </div>
</div>

<!-- Section 2: Product Details/Images Grid (mobile only) -->
<div id="section-2" class="lg:hidden pt-8 pb-4 border-t mx-4 md:mx-auto md:max-w-2xl">
  <div>
    <!-- 2x2 Product Images Grid -->
    <div class="grid grid-cols-2 gap-4 px-4 mb-6">
      <div class="bg-gray-200 h-40 rounded-lg flex items-center justify-center">
        <span class="text-gray-500">Image 1</span>
      </div>
      <div class="bg-gray-200 h-40 rounded-lg flex items-center justify-center">
        <span class="text-gray-500">Image 2</span>
      </div>
      <div class="bg-gray-200 h-40 rounded-lg flex items-center justify-center">
        <span class="text-gray-500">Image 3</span>
      </div>
      <div class="bg-gray-200 h-40 rounded-lg flex items-center justify-center">
        <span class="text-gray-500">Image 4</span>
      </div>
    </div>

    <!-- Product Description -->
    <div class="px-4 mb-6">
      <div class="prose prose-lg text-gray-600 mb-4">
        <% if @product.description.present? %>
          <%= simple_format(@product.description) %>
        <% else %>
          <p>100% natural sage essential oil, made in Europe.</p>
        <% end %>
      </div>

      <!-- Product Features/Benefits -->
      <ul class="list-disc list-inside text-gray-600 space-y-1 text-sm">
        <li>Euismod in pellentesque massa placerat duis ultricies</li>
        <li>Nisi est sit amet facilisis magna etiam</li>
        <li>Non curabitur gravida arcu ac tortor dignissim</li>
        <li>Mattis sodales faucibus, aenean vulputate consectetur et nunc potenti auque</li>
        <li>Proin morbis eros nostra rutrum montes suspendisse</li>
        <li>Aneque nunc hendrerit ligula praesent taciti</li>
      </ul>
    </div>
  </div>
</div>

<!-- Cross-sell Section -->
<div id="section-3" class="mt-8 pt-8 border-t mx-4 lg:mx-8">
  <h2 class="section-heading">you may also like</h2>
  <%= render 'products/cross_sells_container', products: @cross_sell_products %>
</div>